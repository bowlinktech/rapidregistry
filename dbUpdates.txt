/** Grace 02.25.2015 12:04PM **/
ALTER TABLE `rapidregistry`.`programs` 
ADD COLUMN `shareAcrossHierarchy` BIT(1) NULL DEFAULT 0 AFTER `url`;

ALTER TABLE `rapidregistry`.`programs` 
ADD COLUMN `visitsPerDay` INT NULL DEFAULT 1 AFTER `shareAcrossHierarchy`;

ALTER TABLE `rapidregistry`.`programs` 
ADD COLUMN `patientRecon` INT NULL DEFAULT 1 AFTER `visitsPerDay`,
ADD COLUMN `visitRecon` INT NULL DEFAULT 1 AFTER `patientRecon`;

CREATE TABLE `lu_engagementMatchingActions` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `displayText` varchar(45) NOT NULL,
  `status` bit(1) NOT NULL DEFAULT b'1',
  `dateCreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;


INSERT INTO `rapidregistry`.`lu_engagementActions` (`displayText`) VALUES ('No Action');
INSERT INTO `rapidregistry`.`lu_engagementActions` (`displayText`) VALUES ('Overwrite');
INSERT INTO `rapidregistry`.`lu_engagementActions` (`displayText`) VALUES ('Reject');
INSERT INTO `rapidregistry`.`lu_engagementActions` (`displayText`) VALUES ('Use Last Visit');
INSERT INTO `rapidregistry`.`lu_engagementActions` (`displayText`) VALUES ('Put In Queue');


/** grace 02252015 02:47 PM **/
ALTER TABLE `rapidregistry`.`storage_engagements` 
ADD COLUMN `programorghierarchy_detailsId` INT NOT NULL AFTER `engagementId`;

ALTER TABLE `rapidregistry`.`storage_engagements` 
ADD CONSTRAINT `hierarchyDetailsId`
  FOREIGN KEY (`id`)
  REFERENCES `rapidregistry`.`programorghierarchy_details` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  
 /** grace 02262015 09:21 AM **/
 
 drop table if exists `rapidregistry`.lu_engagemenActions;
 
 
  drop table if exists `rapidregistry`.lu_engagementMatchingActions;

 CREATE TABLE `rapidregistry`.`lu_engagementMatchingActions` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `displayText` varchar(45) NOT NULL,
  `status` bit(1) NOT NULL DEFAULT b'1',
  `dateCreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;


INSERT INTO `rapidregistry`.`lu_engagementMatchingActions` (`displayText`) VALUES ('No Action');
INSERT INTO `rapidregistry`.`lu_engagementMatchingActions` (`displayText`) VALUES ('Overwrite');
INSERT INTO `rapidregistry`.`lu_engagementMatchingActions` (`displayText`) VALUES ('Reject');
INSERT INTO `rapidregistry`.`lu_engagementMatchingActions` (`displayText`) VALUES ('Use Last Visit');
INSERT INTO `rapidregistry`.`lu_engagementMatchingActions` (`displayText`) VALUES ('Put In Queue');
 
 
UPDATE `rapidregistry`.`lu_engagementMatchingActions` SET `id`='1' WHERE `id`='5';
UPDATE `rapidregistry`.`lu_engagementMatchingActions` SET `id`='2' WHERE `id`='6';
UPDATE `rapidregistry`.`lu_engagementMatchingActions` SET `id`='3' WHERE `id`='7';
UPDATE `rapidregistry`.`lu_engagementMatchingActions` SET `id`='4' WHERE `id`='8';
UPDATE `rapidregistry`.`lu_engagementMatchingActions` SET `id`='5' WHERE `id`='9';

 
/** chad 02262015 08:29 AM **/
ALTER TABLE `rapidregistry`.`survey_questions` 
ADD COLUMN `alphabeticallySort` BIT(1) NOT NULL DEFAULT b'0' AFTER `validationId`,
ADD COLUMN `choiceLayout` VARCHAR(45) NULL DEFAULT NULL AFTER `alphabeticallySort`,
ADD COLUMN `populateFromTable` VARCHAR(45) NULL DEFAULT NULL AFTER `choiceLayout`;

ALTER TABLE `rapidregistry`.`survey_questionChoices` 
ADD COLUMN `choiceValue` INT(11) NULL DEFAULT '0' AFTER `defAnswer`;



/** grace 02262015 10:27AM **/
CREATE TABLE `rapidregistry`.`lu_MCI_Categories` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `displayText` VARCHAR(45) NOT NULL,
  `status` BIT NOT NULL DEFAULT 1,
  `dateCreated` DATETIME NOT NULL DEFAULT current_timestamp,
  PRIMARY KEY (`id`));

INSERT INTO `rapidregistry`.`lu_MCI_Categories` (`displayText`) VALUES ('Patient');
INSERT INTO `rapidregistry`.`lu_MCI_Categories` (`displayText`) VALUES ('Visit');


ALTER TABLE `rapidregistry`.`programuploadtypes` 
CHANGE COLUMN `useMCI` `useHEL` BIT(1) NULL DEFAULT b'1' ;


DROP TABLE if exists `rapidregistry`.`program_mcienrollmethod`;
DROP TABLE if exists `rapidregistry`.`program_mcimatchingmethod`;

DROP TABLE if exists `rapidregistry`.`programUploadHELPaths`;

ALTER TABLE `rapidregistry`.`programuploadtypes` 
CHANGE COLUMN `useHEL` `useHEL` BIT(1) NULL DEFAULT 0 ,
ADD COLUMN `HELDropPath` VARCHAR(75) NULL AFTER `useHEL`,
ADD COLUMN `HELPickUpPath` VARCHAR(75) NULL AFTER `HELDropPath`,
CHANGE COLUMN `dateCreated` `dateCreated` DATETIME NOT NULL 
DEFAULT CURRENT_TIMESTAMP AFTER `HELPickUpPath`;


ALTER TABLE `rapidregistry`.`programuploads` 
ADD COLUMN `batchFileName` VARCHAR(55) NULL AFTER `fileName`,
ADD COLUMN `batchId` VARCHAR(55) NULL AFTER `batchFileName`;


ALTER TABLE `rapidregistry`.`programuploads` 
ADD COLUMN `statusId` INT NOT NULL AFTER `UTBatchId`;

ALTER TABLE `rapidregistry`.`programuploadtypes` 
CHANGE COLUMN `useHEL` `useHEL` BIT(1) NOT NULL DEFAULT b'0' ;

ALTER TABLE `rapidregistry`.`program_mcialgorithms` 
ADD COLUMN `programUploadTypeId` INT NOT NULL AFTER `programId`;

ALTER TABLE `rapidregistry`.`program_mcialgorithms` 
RENAME TO  `rapidregistry`.`programUpload_mcialgorithms` ;

ALTER TABLE `rapidregistry`.`programUpload_mcialgorithms` 
ADD INDEX `fk_programUploadId_idx` (`programUploadTypeId` ASC);
ALTER TABLE `rapidregistry`.`programUpload_mcialgorithms` 
ADD CONSTRAINT `fk_programUploadId`
  FOREIGN KEY (`programUploadTypeId`)
  REFERENCES `rapidregistry`.`programuploadtypes` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
ALTER TABLE `rapidregistry`.`programUpload_mcialgorithms` 
DROP FOREIGN KEY `fk_programMPIAlgorithms_programId`;
ALTER TABLE `rapidregistry`.`programUpload_mcialgorithms` 
DROP COLUMN `programId`,
DROP INDEX `programId` ;
  
ALTER TABLE `rapidregistry`.`programUpload_MCIalgorithms` 
CHANGE COLUMN `dateCreated` `dateCreated` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ,
ADD COLUMN `mci_CategoryId` INT NOT NULL DEFAULT 1 AFTER `action`;

ALTER TABLE `rapidregistry`.`programUpload_MCIalgorithms` 
ADD INDEX `mciCategoryId_idx` (`mci_CategoryId` ASC);
ALTER TABLE `rapidregistry`.`programUpload_MCIalgorithms` 
ADD CONSTRAINT `mciCategoryId`
  FOREIGN KEY (`mci_CategoryId`)
  REFERENCES `rapidregistry`.`lu_MCI_Categories` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
ALTER TABLE `rapidregistry`.`programuploadtypes` 
CHANGE COLUMN `HELDropPath` `HELDropPath` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL ,
CHANGE COLUMN `HELPickUpPath` `HELPickUpPath` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL ;
  





